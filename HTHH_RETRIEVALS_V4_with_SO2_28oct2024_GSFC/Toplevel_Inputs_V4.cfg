 --------- Retrieval scene pre-screening
1
1  30  139
-1.00
 --------- RT Control
3  1       ! Number of Stokes vector elements 
8          ! Half the # of RT streams
4          ! Fine layer control for FOCORR_OUTGOING
f
 --------- Wavelength limits [nm]
289.0  
296.0  
 --------- Plume control
34.0          ! Upper limit of plume [km]
24.0          ! Lower limit of plume [km]
0.41          ! Halfwidth half max of plume [km]
F             ! Flag for retrieving Aer plume HWHM (not active)
312.0         ! Reference wavelength [nm]
3.0           ! First-guess value of AOD
30.0          ! First-guess value of Aer Peak Height [km]
 --------- SO2 Control
T             ! Flag for including SO2
Bogumil       ! SO2 XSec file
5.0           ! SO2 total amount (DU)
F             ! Retrieve SO2
 --------- Aerosol scattering control
F             ! Flag for retrieving nreal
F             ! Flag for retrieving nimag
1.0000        ! Bimodal number fraction (PSD #1)
1.470         ! PSD #1 (fine mode)   - refrac index: real part
0.0001        ! PSD #1 (fine mode)   - refrac index: imag part
0.1392        ! PSD #1 (fine mode)   - RTS Mie PSD #4 mode radius (in um)
1.545         ! PSD #1 (fine mode)   - RTS Mie PSD #4 std dev (unitless)
1.470         ! PSD #2 (coarse mode) - refrac index: real part
0.0001        ! PSD #2 (coarse mode) - refrac index: imag part
1.333         ! PSD #2 (coarse mode) - RTS Mie PSD #4 mode radius (in um)
1.828         ! PSD #2 (coarse mode) - RTS Mie PSD #4 std dev (unitless)
F             ! Performs Mie calcs and dumps Mie results to file ONLY
T             ! Uses Mie file data if TRUE; Mie computed on the fly if FALSE
 --------- Surface control (planetary surface or cloud top)
0.0           ! Surface or cloudtop height [km]
0.06          ! Surface or cloudtop albedo


      OPEN(1,file='Toplevel_Inputs_V4.cfg', STATUS = 'old')
      read(1,*) ! RETRIEVAL SCENE PRE-SCREENING
      read(1,*)idx_lo
      read(1,*)idx_hi
      read(1,*)CSI_threshold
      read(1,*) !       RT CONTROL
      read(1,*)nstokes               ! NSTOKES in VLIDORT
      read(1,*)nstreams              ! NSTREAMS in VLIDORT
      read(1,*)nssfine               ! fine layer control for FOCORR_OUTGOING in VLIDORT
      read(1,*)do_ssonly             ! No multiple scatter in VLIDORT ==> very fast !
      read(1,*) !       WAVELENGTH LIMITS
      read(1,*)lambda_1              ! Lower wavelength buffer limit [nm]
      read(1,*)lambda_2              ! Upper wavelength buffer limit [nm]
      read(1,*) !       PLUME CONTROL
      read(1,*)plumetop              ! Upper limit   of plume [km]
      read(1,*)plumebot              ! Lower limit   of plume [km]
      read(1,*)plumehwhm_firstguess  ! halfwidth half max of plume [km]
      read(1,*)retrieve_plumehwhm    ! Flag for retrieving plume hwhm
      read(1,*)AOD_refw              ! Reference wavelength [nm]
      read(1,*)AOD_firstguess        ! First-guess value of AOD
      read(1,*)Pkht_firstguess       ! First-guess value of Peak Height [km]
      read(1,*) !       SO2 CONTROL
      read(1,*)Include_SO2           ! Flag for including SO2
      read(1,*)SO2XSec_Source        ! SO2 XSec source file
      read(1,*)SO2_firstguess        ! First-guess value of total column SO2 (DU)
      read(1,*)retrieve_SO2          ! Flag for retrieving SO2
      read(1,*) !       MIE CONTROL
      read(1,*)retrieve_nreal        ! Flag for retrieving nreal
      read(1,*)retrieve_nimag        ! Flag for retrieving nimag
      read(1,*)Bimodal_fraction      ! Bimodal fraction (PSD #1)
      read(1,*)nreal_firstguess(1)   ! Mie program input: PSD #1 (fine mode)
      read(1,*)nimag_firstguess(1)   ! Mie program input: PSD #1 (fine mode)
      read(1,*)psdpar1_firstguess(1) ! Mie program input: PSD #1 (fine mode)
      read(1,*)psdpar2_firstguess(1) ! Mie program input: PSD #1 (fine mode)
      read(1,*)nreal_firstguess(2)   ! Mie program input: PSD #2 (coarse mode)
      read(1,*)nimag_firstguess(2)   ! Mie program input: PSD #2 (coarse mode)
      read(1,*)psdpar1_firstguess(2) ! Mie program input: PSD #2 (coarse mode)
      read(1,*)psdpar2_firstguess(2) ! Mie program input: PSD #2 (coarse mode)
      read(1,*)Do_Initial_Mie_Calculations  ! Performs desired Mie calculations and dumps Mie results to file ONLY
      read(1,*)Use_Initial_Mie_Calculations ! Uses dumped Mie data directly if TRUE; otherwise, Mie is computed on the fly!
      read(1,*) !       SURFACE CONTROL
      read(1,*)Surface_height        !Surface or cloudtop height [km]
      read(1,*)Surface_albedo        !Surface or cloudtop albedo
      close(1)

